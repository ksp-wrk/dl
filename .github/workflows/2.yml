# https://examplefile.com/file-download/453
# https://master.dl.sourceforge.net/project/crdroid/daisy/6.x/crDroidAndroid-10.0-20210703-daisy-v6.19.zip?viasf=1"
name: Download crDroid and Upload to Mega

on:
  workflow_dispatch:  # Manual trigger

jobs:
  download-and-upload:
    runs-on: ubuntu-latest
    steps:

      # 1️⃣ Checkout repo (optional)
      - name: Checkout Repo
        uses: actions/checkout@v3

      # 2️⃣ Download crDroid zip from SourceForge
      - name: Download crDroid Daisy v6.19
        run: |
          curl -L -o daisy8a12.zip "https://phoenixnap.dl.sourceforge.net/project/crdroid/daisy/8.x/crDroidAndroid-12.1-20220815-daisy-v8.8.zip?viasf=1"
      
      # 4️⃣ Upload to Mega.nz
      - name: Upload to Mega.nz
        uses: Difegue/action-megacmd@master
        with:
          args: put daisy8a12.zip /
        env:
          USERNAME: ${{ secrets.MEGA_EMAIL }}
          PASSWORD: ${{ secrets.MEGA_PASSWORD }}

      # 5️⃣ Generate public Mega share link
      - name: Get Mega Share Link
        uses: Difegue/action-megacmd@master
        id: mega_link
        with:
          args: export /daisy8a12.zip
        env:
          USERNAME: ${{ secrets.MEGA_EMAIL }}
          PASSWORD: ${{ secrets.MEGA_PASSWORD }}

      # 6️⃣ Output Mega link to workflow
      - name: Show Mega Share Link
        run: |
          echo "Mega Share Link: ${{ steps.mega_link.outputs.stdout }}"
